<!DOCTYPE html>
<html lang="en">

<head>
	<title>Shoping Cart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--===============================================================================================-->
	<link rel="icon" href=" /assets/imgs/theme/Black White Logo.png">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/iconic/css/material-design-iconic-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/linearicons-v1.0.0/icon-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/perfect-scrollbar/perfect-scrollbar.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/util.css">
	<link rel="stylesheet" type="text/css" href="/css/main.css">
	<!--===============================================================================================-->
	<link href="/uiHome/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
	<link href="/uiHome/css/tiny-slider.css" rel="stylesheet">
	<link href="/uiHome/css/style.css" rel="stylesheet">
</head>
<style>
.footer-divider {
    width: 100%; /* Increase the width to 95% */
    height: 0.5px;
    background-color: #c6bdbd;
    margin: 20px auto; /* Center the divider horizontally */
	margin-top: 50px;
}
</style>
<body>
	<!-- Start Header/Navigation -->
	<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">
		<div class="container">
			<a class="navbar-brand" href="index.html">Halang<span>.</span></a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni"
				aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarsFurni">
				<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
					<li><a class="nav-link" href="/">Home</a></li>
					<li><a class="nav-link" href="/products">Shop</a></li>
					<li><a class="nav-link" href="about.html">About us</a></li>
					<li><a class="nav-link" href="services.html">Services</a></li>
					<li><a class="nav-link" href="blog.html">Contact us</a></li>

				</ul>
				<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
					<li><a class="nav-link" href="/profile"><img src="/uiHome/images/user.svg"></a></li>
					<li><a class="nav-link" href="/cart"><img src="/uiHome/images/cart.svg"></a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- breadcrumb -->
	<div class="container">
		<div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
			
		</div>
	</div>

	    <!-- checkout -->
<div class="page-content">
    <div class="checkout">
        <div class="container">
           
            <form action="/editAddress" method="post" id="editaddressForm">
                <div class="row">
					<div class="col-lg-9">
						<h2 class="checkout-title">Edit address</h2><!-- End .checkout-title -->
						<div class="row">
							<div class="col-sm-6">
								<label>Name</label>
								<input type="text" name="name"class="form-control" value="<%= selectedAddress.name %>" >
								<p id="nameError" class="error-message" style="color: red;"></p>
							</div><!-- End .col-sm-6 -->
							
							<div class="col-sm-6">
								<label>Phone </label>
								<input type="tel" name="tel"class="form-control"value="<%= selectedAddress.tel %>" >
								<p id="phoneError" class="error-message" style="color: red;"></p>
							</div><!-- End .col-sm-6 -->
						</div><!-- End .row -->
						<div class="row">
							<div class="col-sm-6">
								<label>Address</label>
								<input type="text" name="address" class="form-control" value="<%= selectedAddress.address %>" >
								<p id="addressError" class="error-message" style="color: red;"></p>
						</div>
						 <div class="col-sm-6">
							<label>State</label>
							<input type="text"name="state" class="form-control" value="<%= selectedAddress.state %>" >
							<p id="stateError" class="error-message" style="color: red;"></p>
						</div><!-- End .col-sm-6 -->
					</div>
						<div class="row">
							<div class="col-sm-6">
								<label>City </label>
								<input type="text" name="city" class="form-control"value="<%= selectedAddress.city %>" >
								<p id="cityError" class="error-message" style="color: red;"></p>
							</div><!-- End .col-sm-6 -->
							<div class="col-sm-6">
								<label>Pincode</label>
								<input type="text" name="pincode" class="form-control" value="<%= selectedAddress.pincode %>" >
								<p id="pincodeError" class="error-message" style="color: red;"></p>
							</div><!-- End .col-sm-6 -->

						</div><!-- End .row -->    
					</div><!-- End .col-lg-9 -->
				</div><!-- End .row -->
				<button type="submit" class="btn btn-primary-2" onclick="validateForm()">Submit</button>
            </form>
        </div><!-- End .container -->
    </div><!-- End .checkout -->
</div><!-- End .page-content -->
</main><!-- End .main -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
	$(document).ready(function () {
		$('#editaddressForm').submit(function (event) {
			event.preventDefault();
			if (validateForm()) {
				const addressIndex = window.location.pathname.split('/').pop();;
				var formData = $(this).serialize();
				$.ajax({
					url: `/editaddress/${addressIndex}`, 
					method: 'POST',
					data: formData,
					success: function (response) {
						window.location.href  = response.redirect;;
					},
					error: function (error) {
						console.log(error);
					}
				});
			}
		});
	
		function validateForm() {
			const name = $('input[name="name"]').val().trim();
			const phone = $('input[name="tel"]').val().trim();
			const address = $('input[name="address"]').val().trim();
			const state = $('input[name="state"]').val().trim();
			const city = $('input[name="city"]').val().trim();
			const pincode = $('input[name="pincode"]').val().trim();
	
			const nameError = $('#nameError');
			const phoneError = $('#phoneError');
			const addressError = $('#addressError');
			const stateError = $('#stateError');
			const cityError = $('#cityError');
			const pincodeError = $('#pincodeError');
	
			nameError.text('');
			phoneError.text('');
			addressError.text('');
			stateError.text('');
			cityError.text('');
			pincodeError.text('');
	
			let maxNameLength = 50;
			let maxAddressLength = 200;
			let maxStateLength = 50;
			let maxCityLength = 50;
			let isValid = true;
	
			if (name === '') {
				nameError.text('Please enter a name.');
				isValid = false;
			} else if (!name.match(/^[a-z ,.'-]+$/i)) {
				nameError.text('Name should not include special characters.');
				isValid = false;
			} else if (name.length > maxNameLength) {
				nameError.text('Name exceeds the maximum limit.');
				isValid = false;
			}
	
			if (phone === '') {
				phoneError.text('Please enter phone number.');
				isValid = false;
			} else if (!phone.match(/^[6789]\d{9}$/)) {
				phoneError.text('Please enter a valid phone number.');
				isValid = false;
			}
	
			if (address === '') {
				addressError.text('Please enter an address.');
				isValid = false;
			} else if (address.length > maxAddressLength) {
				addressError.text('Address exceeds the maximum limit.');
				isValid = false;
			}
	
			if (state === '') {
				stateError.text('Please enter your state.');
				isValid = false;
			} else if (!state.match(/^[a-z ,.'-]+$/i)) {
				stateError.text('State should not include special characters.');
				isValid = false;
			} else if (state.length > maxStateLength) {
				stateError.text('State exceeds the maximum limit.');
				isValid = false;
			}
	
			if (city === '') {
				cityError.text('Please enter your city.');
				isValid = false;
			} else if (!city.match(/^[a-z ,.'-]+$/i)) {
				cityError.text('City should not include special characters.');
				isValid = false;
			} else if (city.length > maxCityLength) {
				cityError.text('City exceeds the maximum limit.');
				isValid = false;
			}
	
			if (pincode === '') {
				pincodeError.text('Please enter your pincode.');
				isValid = false;
			} else if (!pincode.match(/^[1-9]\d{5}$/) || pincode.length < 6) {
				pincodeError.text('Please enter a valid pincode.');
				isValid = false;
			}
	
			return isValid;
		}
	});
</script>

<%- include('../layouts/partials/footer.ejs') %>